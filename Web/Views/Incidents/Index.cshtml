@using System.Web
@using ViewModels.Incident
@model IncidentViewModel

<style>
    .text-submitted {
        color: red;
    }

    .status-submitted {
        background-color: red;
    }

    .status-validated {
        background-color: darkorange;
    }

    .text-validated {
        color: darkorange;
        font-weight: 600;
    }

    .status-dispatched {
        background-color: orange;
    }

    .text-dispatched {
        color: orange;
        font-weight: 600;
    }

    .status-started {
        background-color: blue;
    }

    .text-started {
        color: blue;
        font-weight: 600;
    }

    .status-completed {
        background-color: limegreen;
    }

    .text-completed {
        color: limegreen;
        font-weight: 600;
    }

    .status-cancelled {
        background-color: grey;
    }

    .text-cancelled {
        color: gray;
        font-weight: 600;
    }

    .badge-low {
        background-color: limegreen;
    }

    .badge-medium {
        background-color: darkorange;
    }

    .badge-high {
        background-color: red;
    }

    .statusFilter {
        margin-right: 16px;
    }

    #statusSelect {
        width: auto;
    }

    .btn.btn-primary {
        width: 200px;
    }

    .form-control.search-input {
        height: 38px;
        min-height: 38px;
    }

    th, td {
        white-space: nowrap;
        text-align: left !important;
    }

    .btnIcon {
        margin-right: 8px;
    }

    .incident-table {
        overflow-y: hidden;
        overflow-x: auto;
        overflow: visible !important;
    }

    .customTableDropdown .dropdown-toggle {
        font-size: 14px;
        padding: 4px 15px 4px 15px !important;
        color: #ffffff !important;
    }

        .customTableDropdown .dropdown-toggle:hover {
            background-color: transparent !important;
            border-color: #000000;
            color: #000000 !important;
        }

            .customTableDropdown .dropdown-toggle:hover::before {
                filter: brightness(0) !important;
            }

        .customTableDropdown .dropdown-toggle::before {
            display: none;
            /*    width: 11px;
                filter: brightness(1) !important;
                left: 81% !important;
                rotate: 92deg !important; */
        }

        .customTableDropdown .dropdown-toggle.status-started::before {
            left: 71% !important;
        }

    .eyeIcon {
        color: #1d4ed8;
    }

    .noteIcon {
        color: #15803d;
    }

    .historyIcon {
        color: #7e22ce;
    }

    .editIcon {
        color: #f54e00;
    }

    .map i.fa {
        color: grey;
        margin-right: 5px;
    }

    .date-time-sec p {
        font-size: 14px;
        font-weight: 400;
        margin-bottom: 1px;
    }

    .AddIncident {
        margin-left: 16px;
    }

    .incidentFilter {
        margin-bottom: 20px;
    }

    .InfoCard {
        border-radius: 6px;
        background: #f7f7f7;
    }

    .CustomTab .nav-link {
        border: none;
        color: #2f2f2f !important;
        border-bottom: none !important;
        border-radius: 0;
        text-align:left !important;
    }

        .CustomTab .nav-link:hover {
            color: #000 !important;
            border-bottom: none !important;
        }

        .CustomTab .nav-link.active {
            color: #ffffff !important;
            border-bottom: 1px solid #f54e00 !important;
            background-color: #f54e00 !important;
            border-radius: 8px;
        }

            .CustomTab .nav-link.active i.fa {
                color: #ffffff !important;
            }

            .CustomTab .nav-link.active:hover {
                color: #ffffff !important;
                border: 1px solid #f54e00 !important;
            }

    .CustomTab .nav-item {
        margin-bottom: 8px !important;
        display: block !important;
        width: 100% !important;
    }

    .CustomTab .nav-link .fa {
        margin-right: 10px !important;
    }

    .nav-link i.fa {
        color: #f54e00;
    }

    .checkBoxTitle {
        font-size: 18px;
        font-weight: 500;
        margin-bottom: 15px;
    }

    .checkBoxTitle {
        font-size: 18px;
        font-weight: 500;
        margin-bottom: 15px;
    }

    #addIncidentModal .form-check-input {
        width: 20px;
        height: 20px;
        margin-right: 8px;
    }

    #addIncidentModal .form-check-label {
        font-size: 15px;
    }

    #addIncidentModal .form-label {
        font-size: 15px;
    }

    /********************View Incident css***************************/
    #viewIncidentModal .badge-status {
        background-color: #dc3545;
        font-size: 0.875rem;
        padding: 0.4rem 0.8rem;
    }

    #viewIncidentModal .badge-severity {
        background-color: #28a745;
        font-size: 0.875rem;
        padding: 0.4rem 0.8rem;
    }

    #viewIncidentModal .badge-unknown {
        background-color: #e5e7eb;
        color: #374151;
    }

    #viewIncidentModal .badge-yes {
        background-color: #28a745;
    }

    #viewIncidentModal .badge-no {
        background-color: #c6f6d5;
        color: #155724;
    }

    #viewIncidentModal .asset-badge {
        background-color: #e5e7eb;
        color: #374151;
        margin-right: 0.25rem;
        font-size: 0.8rem;
    }

    #viewIncidentModal .section-title {
        font-weight: 600;
        font-size: 19px;
        margin-bottom: 0.75rem;
    }

    #viewIncidentModal .info-label {
        font-weight: 500;
    }

    #viewIncidentModal .card,
    #noteIncidentModal .card,
    #historyIncidentModal .card {
        border-radius: 6px;
        background: #f7f7f7;
        margin-bottom: 22px;
        padding: 16px;
    }

    .callerInfo i.fa {
        margin-right: 8px;
    }
    /********************Note Modal Css********************/
    #noteIncidentModal .card h3 {
        margin-top: 0;
        margin-bottom: 15px;
        font-size: 18px;
        font-weight: bold;
    }

    #noteIncidentModal .log-item {
        display: flex;
        align-items: flex-start;
        margin-bottom: 15px;
    }

    #noteIncidentModal .log-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 10px;
        font-size: 14px;
    }

    #noteIncidentModal .log-header {
        font-size: 14px;
        font-weight: bold;
    }

    #noteIncidentModal .tag {
        display: inline-block;
        font-size: 12px;
        padding: 2px 8px;
        border-radius: 12px;
        margin-left: 5px;
        color: #fff;
    }

        #noteIncidentModal .tag.system {
            background: #2563eb;
        }

        #noteIncidentModal .tag.internal {
            background: #9ca3af;
        }

    #noteIncidentModal .log-time {
        font-size: 12px;
        color: #6b7280;
        margin-left: 5px;
        font-weight: 400;
    }

    #noteIncidentModal .log-text {
        font-size: 14px;
        color: #111827;
        margin-top: 2px;
    }

    .communication-sec h3 {
        border-bottom: 1px solid #eeeeee;
    }

    /* Right Section */


    #noteIncidentModal .form-group {
        margin-bottom: 15px;
    }

    #noteIncidentModal label {
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
    }

    #noteIncidentModal select, #noteIncidentModal textarea {
        width: 100%;
        padding: 8px;
        border: 1px solid #d1d5db;
        border-radius: 6px;
        font-size: 14px;
    }

    #noteIncidentModal textarea {
        resize: vertical;
        min-height: 80px;
    }

    #noteIncidentModal .btn {
        width: 100%;
        padding: 10px;
        border: none;
        border-radius: 6px;
        background: #F54E00;
        color: white;
        font-size: 15px;
        font-weight: bold;
        cursor: pointer;
    }

        #noteIncidentModal .btn:hover {
            background: #ff7332;
        }

    #noteIncidentModal .summary p {
        margin: 5px 0;
        font-size: 14px;
        font-weight: 400;
    }

        #noteIncidentModal .summary p span {
            font-weight: bold;
        }

    #noteIncidentModal .modal-dialog {
        width: 1200px;
    }
    /**********************history modal css*************************/
    /* Left timeline */


    #historyIncidentModal .timeline h3 {
        margin-bottom: 20px;
        font-size: 18px;
        font-weight: bold;
    }

    #historyIncidentModal .timeline ul {
        list-style: none;
        padding: 0;
        position: relative;
    }

        #historyIncidentModal .timeline ul::before {
            content: '';
            position: absolute;
            left: 18px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #e5e7eb;
        }

    #historyIncidentModal .timeline li {
        position: relative;
        margin-bottom: 25px;
        padding-left: 50px;
    }

        #historyIncidentModal .timeline li:last-child {
            margin-bottom: 0;
        }

        #historyIncidentModal .timeline li .icon {
            position: absolute;
            left: -2px;
            top: 0;
            background: #fff;
            border-radius: 50%;
            border: 2px solid #e5e7eb;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }



        #historyIncidentModal .timeline li .title {
            font-weight: bold;
            margin-bottom: 4px;
        }

        #historyIncidentModal .timeline li .author {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 4px;
            line-height: normal;
        }

        #historyIncidentModal .timeline li .desc {
            font-size: 14px;
            color: #374151;
            margin-bottom: 4px;
            line-height: normal;
        }

        #historyIncidentModal .timeline li .time {
            font-size: 12px;
            color: #6b7280;
        }

    /* Different colors */
    #historyIncidentModal .blue {
        color: #3b82f6;
        border-color: #3b82f6;
    }

    #historyIncidentModal .yellow {
        color: #f59e0b;
        border-color: #f59e0b;
    }

    #historyIncidentModal .green {
        color: #10b981;
        border-color: #10b981;
    }

    #historyIncidentModal .purple {
        color: #8b5cf6;
        border-color: #8b5cf6;
    }


    #historyIncidentModal .card h4 {
        margin-bottom: 12px;
        font-size: 16px;
        font-weight: bold;
        line-height: normal;
    }

    #historyIncidentModal .card p {
        font-size: 14px;
        margin: 4px 0;
        display: flex;
        justify-content: space-between;
        font-weight: 400;
    }

    #historyIncidentModal .content .right-sec p {
        font-size: 12px;
        margin-bottom: 4px;
        display: block;
        font-weight: 400;
        line-height: normal;
        text-align: right;
    }

    .newAddFormSidebar {
        border-radius: 6px;
        background: #f7f7f7;
        margin-bottom: 22px;
        padding: 16px;
    }

    #historyIncidentModal .historyModalTable {
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch !important;
    }
</style>

<div class="incidentSec">
    <div class="topSearchbar">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h3>Incident</h3>
            <div class="right-sec d-flex  align-items-center mb-3">

                <div class="search-container me-3">
                    <i class="fa-solid fa-magnifying-glass search-icon"></i>
                    <input type="text" class="form-control search-input" placeholder="Search incidents..." id="global_search_value">
                </div>
                <div class="statusFilter">
                    <select class="form-select" id="statusSelect" placeholder="status">
                        <option value="" selected>--Select--</option>
                        @foreach (var item in Model.statusLegends)
                        {
                            <option value="@item.Value">@item.Text</option>
                        }
                    </select>
                </div>
                <div class="severityFilter">
                    <select class="form-select" id="severitySelect" placeholder="Severity">
                        <option value="" selected>--Select--</option>
                        @foreach (var item in Model.severityLevels)
                        {
                            <option value="@item.Value">@item.Text</option>
                        }
                    </select>
                </div>
                <a href="#" class="btn btn-primary AddIncident" data-bs-toggle="modal" data-bs-target="#addIncidentModal"><i class="fa fa-plus"></i>Add New Incident</a>
            </div>
        </div>
    </div>

    <div class="table-responsive incident-table" id="incidentGrid">
        @await Html.PartialAsync("~/Views/Incidents/_IncidentGrid.cshtml", Model)
    </div>
</div>

 
<div class="modal fade" id="addIncidentModal" tabindex="-1" aria-labelledby="addIncidentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addIncidentModalModalLabel">Add Incident</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="NewIncidentForm">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="newAddFormSidebar">
                                <ul class="nav nav-pills incidentFilter CustomTab" id="pills-tab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="pills-caller-tab" data-bs-toggle="pill"
                                                data-bs-target="#pills-caller" type="button" role="tab">
                                            <i class="fa fa-user"></i>Caller/Source Information
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link " id="pills-location-tab" data-bs-toggle="pill"
                                                data-bs-target="#pills-location" type="button" role="tab">
                                            <i class="fa fa-map-pin"></i>Location of Incident
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link " id="pills-detail-tab" data-bs-toggle="pill"
                                                data-bs-target="#pills-detail" type="button" role="tab">
                                            <i class="fa fa-list-check"></i>Incident Details
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link " id="pills-description-tab" data-bs-toggle="pill"
                                                data-bs-target="#pills-description" type="button" role="tab">
                                            <i class="fa  fa-address-card"></i>Description of Issue
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link " id="pills-severity-tab" data-bs-toggle="pill"
                                                data-bs-target="#pills-severity" type="button" role="tab">
                                            <i class="fa fa-thermometer-full"></i>Severity
                                        </button>
                                    </li>

                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link " id="pills-safety-tab" data-bs-toggle="pill"
                                                data-bs-target="#pills-safety" type="button" role="tab">
                                            <i class="fa fa-shield"></i>Environmental / Safety Indicators
                                        </button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link " id="pills-support-tab" data-bs-toggle="pill"
                                                data-bs-target="#pills-support" type="button" role="tab">
                                            <i class="fa fa-info-circle"></i>Supporting Information
                                        </button>
                                    </li>



                                </ul>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="tab-content" id="newIncidentTabContent">
                                <div class="tab-pane fade show active" id="pills-caller" role="tabpanel" aria-labelledby="caller-tab">
                                    @await Html.PartialAsync("~/Views/Incidents/_CallerInformation.cshtml", Model)
                                </div>
                                <div class="tab-pane fade" id="pills-location" role="tabpanel" aria-labelledby="location-tab">
                                    @await Html.PartialAsync("~/Views/Incidents/_Location.cshtml", Model)
                                </div>
                                <div class="tab-pane fade" id="pills-detail" role="tabpanel" aria-labelledby="detail-tab">
                                    @await Html.PartialAsync("~/Views/Incidents/_IncidentDetails.cshtml", Model)
                                </div>
                                <div class="tab-pane fade" id="pills-description" role="tabpanel" aria-labelledby="description-tab">
                                    @await Html.PartialAsync("~/Views/Incidents/_DescriptionIssue.cshtml", Model)
                                </div>
                                <div class="tab-pane fade" id="pills-severity" role="tabpanel" aria-labelledby="severity-tab">
                                    @await Html.PartialAsync("~/Views/Incidents/_Severity.cshtml", Model)
                                </div>
                                <div class="tab-pane fade" id="pills-safety" role="tabpanel" aria-labelledby="safety-tab">
                                    @await Html.PartialAsync("~/Views/Incidents/_Environmental.cshtml", Model)
                                </div>
                                <div class="tab-pane fade" id="pills-support" role="tabpanel" aria-labelledby="support-tab">
                                    @await Html.PartialAsync("~/Views/Incidents/_SupportingInformation.cshtml", Model)
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="viewIncidentModal" tabindex="-1" aria-labelledby="viewIncidentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewIncidentModalModalLabel">INC-0001</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-lg-8">
                        <!-- Status & Priority -->
                        <div class="card p-3">
                            <div class="section-title">Status & Priority</div>
                            <div class="row">
                                <div class="col-md-6">
                                    <span class="info-label">Status</span><br>
                                    <span class="badge badge-status">Submitted</span>
                                </div>
                                <div class="col-md-6">
                                    <span class="info-label">Severity</span><br>
                                    <span class="badge badge-severity">Low</span>
                                </div>
                            </div>
                        </div>

                        <!-- Incident Details -->
                        <div class="card p-3">
                            <div class="section-title">Incident Details</div>
                            <label class="info-label">Event Type: </label><p>Gas Leak</p>
                            <label class="info-label">Description: </label><p>Sample incident description 1</p>
                        </div>

                        <!-- Location Information -->
                        <div class="card p-3">
                            <div class="section-title">Location Information</div>
                            <label class="info-label">Address: </label><p>2201 Service Ave, City, ST 12345</p>
                            <label class="info-label">Nearest Intersection: </label> <p>Main St & Service Ave</p>

                            <label class="info-label">Affected Assets: </label>
                            <p>
                                <span class="badge asset-badge">PIPE-001</span>
                                <span class="badge asset-badge">VALVE-123</span>
                            </p>
                        </div>

                        <!-- Safety Assessment -->
                        <div class="card p-3">
                            <div class="section-title">Safety Assessment</div>
                            <div class="row">
                                <div class="col-md-6 mb-2">
                                    Gas Odor Present <span class="badge badge-unknown">Unknown</span>
                                </div>
                                <div class="col-md-6 mb-2">
                                    Hissing Sound <span class="badge badge-no">No</span>
                                </div>
                                <div class="col-md-6 mb-2">
                                    Visible Damage <span class="badge badge-no">No</span>
                                </div>
                                <div class="col-md-6 mb-2">
                                    People Injured <span class="badge badge-no">No</span>
                                </div>
                                <div class="col-md-6 mb-2">
                                    Evacuation Required <span class="badge badge-no">No</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Sidebar -->
                    <div class="col-lg-4">
                        <!-- Caller Information -->
                        <div class="card p-3">
                            <div class="section-title">Caller Information</div>
                            <label class="info-label">Caller 1</label><p><small class="text-muted">Customer</small></p>
                            <div class="callerInfo"><i class="fa fa-phone"></i> 555-829-0947</div>
                            <div class="callerInfo"><i class="fa fa-calendar"></i>Aug 23, 2025 04:14 PM</div>
                            <div class="callerInfo"><i class="fa fa-map-marker"></i> 6093 Main St, City, ST 12345</div>
                        </div>

                        <!-- Timeline -->
                        <div class="card p-3">
                            <div class="section-title">Timeline</div>
                            <div class="timelineInfo">
                                <label class="info-label">Created</label><br>
                                <small class="text-muted">Aug 23, 2025 02:26 AM</small>
                            </div>
                            <div class="timelineInfo">
                                <span class="info-label">Last Updated</span><br>
                                <small class="text-muted">Aug 28, 2025 11:01 AM</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="noteIncidentModal" tabindex="-1" aria-labelledby="noteIncidentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="noteIncidentModalModalLabel">Notes: INC-0001</h5>

                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">

                <div class="row">
                    <div class="col-md-8">
                        <div class="card communication-sec">
                            <h3>Communication Log</h3>

                            <div class="log-item">
                                <div class="log-avatar"><i class="fa fa-user"></i></div>
                                <div class="log-content">
                                    <div class="log-header">
                                        Jason <span class="tag system">external</span>
                                        <span class="log-time">Aug 22, 2025 10:53 AM</span>
                                    </div>
                                    <div class="log-text">
                                        Initial incident report received from customer. Gas odor reported at location.
                                    </div>
                                </div>
                            </div>

                            <div class="log-item">
                                <div class="log-avatar"><i class="fa fa-user"></i></div>
                                <div class="log-content">
                                    <div class="log-header">
                                        John Smith <span class="tag internal">internal</span>
                                        <span class="log-time">Aug 22, 2025 11:23 AM</span>
                                    </div>
                                    <div class="log-text">
                                        Contacted customer for additional details. Confirmed strong gas odor near meter.
                                    </div>
                                </div>
                            </div>

                            <div class="log-item">
                                <div class="log-avatar"><i class="fa fa-user"></i></div>
                                <div class="log-content">
                                    <div class="log-header">
                                        Sarah Johnson <span class="tag internal">internal</span>
                                        <span class="log-time">Aug 22, 2025 11:38 AM</span>
                                    </div>
                                    <div class="log-text">
                                        Dispatched emergency response team. ETA 15 minutes.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">

                        <div class="card">
                            <h3>Add Note</h3>
                            <div class="form-group">
                                <label>Note Type</label>
                                <select>
                                    <option>Internal Note</option>
                                    <option>External Note</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Note Content</label>
                                <textarea placeholder="Enter your note..."></textarea>
                            </div>
                            <button class="btn">+ Add Note</button>
                        </div>

                        <div class="card summary">
                            <h3>Incident Summary</h3>
                            <p><span>Status:</span> Started</p>
                            <p><span>Type:</span> Gas Leak</p>
                            <p><span>Severity:</span> High</p>
                            <p><span>Location:</span> 1531 Service Ave, City, ST 12345</p>
                        </div>

                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="historyIncidentModal" tabindex="-1" aria-labelledby="historyIncidentModalModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="historyIncidentModalModalModalLabel">History: INC-0001</h5>

                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <h4>Activity Summary</h4>
                            <p><span>Status Changes</span><span>3</span></p>
                            <p><span>Notes Added</span><span>1</span></p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <h4>Time Metrics</h4>
                            <p><span>Created</span><span>Aug 24, 2025 02:30 AM</span></p>
                            <p><span>Last Updated</span><span>Aug 29, 2025 10:37 AM</span></p>

                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="table-responsive incident-table historyModalTable">
                            <table class="table align-middle text-left">
                                <thead class="table-light">
                                    <tr>
                                        <th>Status</th>
                                        <th>Location</th>
                                        <th>Intersection</th>
                                        <th>Type of Event</th>
                                        <th>Severity</th>
                                        <th>Description</th>
                                        <th>ES Indicators</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="status-submitted">
                                            <div class="dropdown customTableDropdown">
                                                <button class="btn status-submitted rounded-pill px-3 dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                    Submitted
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><div class="dropdown-item text-submitted">Submitted</div></li>
                                                    <li><div class="dropdown-item text-validated">Validated</div></li>
                                                    <li><div class="dropdown-item text-dispatched" href="#">Dispatched</div></li>
                                                    <li><div class="dropdown-item text-started" href="#">Started</div></li>
                                                    <li><div class="dropdown-item text-completed" href="#">Completed</div></li>
                                                    <li><div class="dropdown-item text-cancelled" href="#">Cancelled</div></li>
                                                </ul>
                                            </div>
                                        </td>
                                        <td><div class="map"><i class="fa fa-map-marker"></i>3069 Service Ave, City, ST 12345</div></td>
                                        <td>Main St & 1st Ave</td>
                                        <td>Power Outage</td>
                                        <td><span class="badge rounded-pill badge-low px-3 py-2">Low</span></td>
                                        <td>Transformer failure</td>
                                        <td>Yes</td>
                                    </tr>
                                    <tr>
                                        <td class="status-submitted">
                                            <div class="dropdown customTableDropdown">
                                                <button class="btn status-validated rounded-pill px-3 dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                    Validated
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><div class="dropdown-item text-submitted">Submitted</div></li>
                                                    <li><div class="dropdown-item text-validated">Validated</div></li>
                                                    <li><div class="dropdown-item text-dispatched" href="#">Dispatched</div></li>
                                                    <li><div class="dropdown-item text-started" href="#">Started</div></li>
                                                    <li><div class="dropdown-item text-completed" href="#">Completed</div></li>
                                                    <li><div class="dropdown-item text-cancelled" href="#">Cancelled</div></li>
                                                </ul>
                                            </div>
                                        </td>
                                        <td><div class="map"><i class="fa fa-map-marker"></i>3069 Service Ave, City, ST 12345</div></td>
                                        <td>Main St & 1st Ave</td>
                                        <td>Power Outage</td>
                                        <td><span class="badge rounded-pill badge-high px-3 py-2">High</span></td>
                                        <td>Transformer failure</td>
                                        <td>Yes</td>
                                    </tr>

                                    <tr>
                                        <td class="status-submitted">
                                            <div class="dropdown customTableDropdown">
                                                <button class="btn status-submitted rounded-pill px-3 dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                    Submitted
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><div class="dropdown-item text-submitted">Submitted</div></li>
                                                    <li><div class="dropdown-item text-validated">Validated</div></li>
                                                    <li><div class="dropdown-item text-dispatched" href="#">Dispatched</div></li>
                                                    <li><div class="dropdown-item text-started" href="#">Started</div></li>
                                                    <li><div class="dropdown-item text-completed" href="#">Completed</div></li>
                                                    <li><div class="dropdown-item text-cancelled" href="#">Cancelled</div></li>
                                                </ul>
                                            </div>
                                        </td>
                                        <td><div class="map"><i class="fa fa-map-marker"></i>3069 Service Ave, City, ST 12345</div></td>
                                        <td>Main St & 1st Ave</td>
                                        <td>Power Outage</td>
                                        <td><span class="badge rounded-pill badge-low px-3 py-2">Low</span></td>
                                        <td>Transformer failure</td>
                                        <td>Yes</td>
                                    </tr>
                                    <tr>
                                        <td class="status-submitted">
                                            <div class="dropdown customTableDropdown">
                                                <button class="btn status-validated rounded-pill px-3 dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                    Validated
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><div class="dropdown-item text-submitted">Submitted</div></li>
                                                    <li><div class="dropdown-item text-validated">Validated</div></li>
                                                    <li><div class="dropdown-item text-dispatched" href="#">Dispatched</div></li>
                                                    <li><div class="dropdown-item text-started" href="#">Started</div></li>
                                                    <li><div class="dropdown-item text-completed" href="#">Completed</div></li>
                                                    <li><div class="dropdown-item text-cancelled" href="#">Cancelled</div></li>
                                                </ul>
                                            </div>
                                        </td>
                                        <td><div class="map"><i class="fa fa-map-marker"></i>3069 Service Ave, City, ST 12345</div></td>
                                        <td>Main St & 1st Ave</td>
                                        <td>Power Outage</td>
                                        <td><span class="badge rounded-pill badge-high px-3 py-2">High</span></td>
                                        <td>Transformer failure</td>
                                        <td>Yes</td>
                                    </tr>

                                    <tr>
                                        <td class="status-submitted">
                                            <div class="dropdown customTableDropdown">
                                                <button class="btn status-submitted rounded-pill px-3 dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                    Submitted
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><div class="dropdown-item text-submitted">Submitted</div></li>
                                                    <li><div class="dropdown-item text-validated">Validated</div></li>
                                                    <li><div class="dropdown-item text-dispatched" href="#">Dispatched</div></li>
                                                    <li><div class="dropdown-item text-started" href="#">Started</div></li>
                                                    <li><div class="dropdown-item text-completed" href="#">Completed</div></li>
                                                    <li><div class="dropdown-item text-cancelled" href="#">Cancelled</div></li>
                                                </ul>
                                            </div>
                                        </td>
                                        <td><div class="map"><i class="fa fa-map-marker"></i>3069 Service Ave, City, ST 12345</div></td>
                                        <td>Main St & 1st Ave</td>
                                        <td>Power Outage</td>
                                        <td><span class="badge rounded-pill badge-low px-3 py-2">Low</span></td>
                                        <td>Transformer failure</td>
                                        <td>Yes</td>
                                    </tr>
                                    <tr>
                                        <td class="status-submitted">
                                            <div class="dropdown customTableDropdown">
                                                <button class="btn status-validated rounded-pill px-3 dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                                    Validated
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li><div class="dropdown-item text-submitted">Submitted</div></li>
                                                    <li><div class="dropdown-item text-validated">Validated</div></li>
                                                    <li><div class="dropdown-item text-dispatched" href="#">Dispatched</div></li>
                                                    <li><div class="dropdown-item text-started" href="#">Started</div></li>
                                                    <li><div class="dropdown-item text-completed" href="#">Completed</div></li>
                                                    <li><div class="dropdown-item text-cancelled" href="#">Cancelled</div></li>
                                                </ul>
                                            </div>
                                        </td>
                                        <td><div class="map"><i class="fa fa-map-marker"></i>3069 Service Ave, City, ST 12345</div></td>
                                        <td>Main St & 1st Ave</td>
                                        <td>Power Outage</td>
                                        <td><span class="badge rounded-pill badge-high px-3 py-2">High</span></td>
                                        <td>Transformer failure</td>
                                        <td>Yes</td>
                                    </tr>


                            </table>
                        </div>
                        @*  <div class="timeline card">
                            <h3>Activity Timeline</h3>
                            <ul>
                                <li>
                                    <span class="icon blue"><i class="fa fa-arrow-right"></i></span>
                                    <div class="content">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div class="left-sec">
                                                 <div class="title">Incident Created</div>
                                                <div class="author">by System</div>
                                            </div>
                                            <div class="right-sec">
                                                <div class="text-right time">
                                                    <p class="text-sm text-gray-500">Aug 24, 2025</p>
                                                    <p class="text-xs text-gray-400">02:30 AM</p>
                                                </div>
                                            </div>
                                        </div>
                                       
                                        <div class="desc">Initial incident report submitted</div>
                                       
                                    </div>
                                </li>

                                <li>
                                    <span class="icon blue"><i class="fa fa-exchange"></i></span>
                                    <div class="content">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div class="left-sec">
                                                <div class="title">Status Changed</div>
                                                <div class="author">by John Smith</div>
                                            </div>
                                            <div class="right-sec">
                                                <div class="text-right time">
                                                    <p class="text-sm text-gray-500">Aug 24, 2025</p>
                                                    <p class="text-xs text-gray-400">02:30 AM</p>
                                                </div>
                                            </div>
                                        </div>
                                       
                                        <div class="desc">Status changed from Submitted to Validated</div>
                                        
                                    </div>
                                </li>

                                <li>
                                    <span class="icon yellow"><i class="fa fa-sticky-note"></i></span>
                                    <div class="content">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div class="left-sec">
                                                <div class="title">Note Added</div>
                                                <div class="author">by Sarah Johnson</div>
                                            </div>
                                            <div class="right-sec">
                                                <div class="text-right time">
                                                    <p class="text-sm text-gray-500">Aug 24, 2025</p>
                                                    <p class="text-xs text-gray-400">02:30 AM</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="desc">Added customer contact information and initial assessment</div>
                                      
                                    </div>
                                </li>

                                <li>
                                    <span class="icon green"><i class="fa fa-users"></i></span>
                                    <div class="content">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div class="left-sec">
                                                <div class="title">Team Assigned</div>
                                                <div class="author">by Mike Wilson</div>
                                            </div>
                                            <div class="right-sec">
                                                <div class="text-right time">
                                                    <p class="text-sm text-gray-500">Aug 24, 2025</p>
                                                    <p class="text-xs text-gray-400">02:30 AM</p>
                                                </div>
                                            </div>
                                        </div>
                                       
                                        <div class="desc">Assigned to Emergency Response Team Alpha</div>
                                        
                                    </div>
                                </li>

                                <li>
                                    <span class="icon blue"><i class="fa fa-exchange"></i></span>
                                    <div class="content">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div class="left-sec">
                                                <div class="title">Status Changed</div>
                                                <div class="author">by Emergency Team</div>
                                            </div>
                                            <div class="right-sec">
                                                <div class="text-right time">
                                                    <p class="text-sm text-gray-500">Aug 24, 2025</p>
                                                    <p class="text-xs text-gray-400">02:30 AM</p>
                                                </div>
                                            </div>
                                        </div>
                                       
                                        <div class="desc">Status changed from Validated to Dispatched</div>
                                        
                                    </div>
                                </li>

                                <li>
                                    <span class="icon purple"><i class="fa fa-wrench"></i></span>
                                    <div class="content">
                                        <div class="d-flex align-items-center justify-content-between">
                                            <div class="left-sec">
                                                <div class="title">Field Update</div>
                                                <div class="author">by Field Technician</div>
                                            </div>
                                            <div class="right-sec">
                                                <div class="text-right time">
                                                    <p class="text-sm text-gray-500">Aug 24, 2025</p>
                                                    <p class="text-xs text-gray-400">02:30 AM</p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="desc">Updated safety indicators and location details</div>
                                       
                                    </div>
                                </li>
                            </ul>
                        </div> *@
                    </div>

                </div>




            </div>
        </div>
    </div>
</div>

<script src="~/js/custom/loader/loader.js"></script>
<script src="~/js/masking/initiate-masking.js"></script>
<script src="~/js/views/incident/incidentform.js"></script>


<script>
    document.addEventListener("DOMContentLoaded", function () {

    const eventSelect = document.getElementById('eventTypeId');

    const eventSections  = {
        gas: document.getElementById('gasOptions'),
        equipment: document.getElementById('equipmentOptions'),
        thirdparty: document.getElementById('thirdpartyOptions'),
        natural: document.getElementById('naturalOptions'),
        other: document.getElementById('otherInputWrapper')
    };

    eventSelect.addEventListener('change', function () {
        // hide all first
        Object.values(eventSections).forEach(sec => sec.classList.add('d-none'));

        // show selected
        const selected = this.value;
        if (eventSections[selected]) {
            eventSections[selected].classList.remove('d-none');
        }
    });

    const severitySelect  = document.getElementById('severity');

    const severitySections  = {
      moderate: document.getElementById('moderateOptions'),
      low: document.getElementById('lowOptions'),
      high: document.getElementById('highOptions'),

    };

    severitySelect.addEventListener('change', function () {
      // hide all sections first
      Object.values(severitySections).forEach(sec => sec.classList.add('d-none'));

      // show the relevant one
      const selected = this.value;
      if (severitySections[selected]) {
        severitySections[selected].classList.remove('d-none');
      }
    });

    //   const photoInput = document.getElementById('photoInput');
    // const photoPreview = document.getElementById('photoPreview');

    photoInput.addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          photoPreview.src = e.target.result;
          photoPreview.classList.remove('d-none');
        }
        reader.readAsDataURL(file);
      } else {
        photoPreview.src = "";
        photoPreview.classList.add('d-none');
      }
    });


     $('#historyIncidentModal').on('shown.bs.modal', function () {
      $(this).find('.modal-dialog').css('max-width', '1200px');
    });
     $('#addIncidentModal').on('shown.bs.modal', function () {
      $(this).find('.modal-dialog').css('max-width', '1200px');
    });
     $('#viewIncidentModal').on('shown.bs.modal', function () {
      $(this).find('.modal-dialog').css('max-width', '1200px');
    });
     $('#noteIncidentModal').on('shown.bs.modal', function () {
      $(this).find('.modal-dialog').css('max-width', '1200px');
    });
    });
</script>